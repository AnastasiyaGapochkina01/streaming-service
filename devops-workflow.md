# DevOps Workflow for Media Streaming SaaS
## Общие требования
1) Приложение должно быть полностью докеризовано
2) Для работы с docker images поднят отдельный regsitry
3) Все пункты workflow должны быть задокументированы
4) Создание и настройка инфраструктуры должна производиться с помощью terraform и ansible
5) Все правки в проекте должны осуществляться через git репозиторий
### Отказоустойчивость
1) Продумать отказоустойчивую архитектуру для обеспечения
- SLA: 99.5% uptime
- RTO: < 30 минут
- RPO: < 15 минут
- Health checks: Automated container restart
2) Настроить регулярные бэкапы критичных компонентов системы с проверками на целостность
### Автоматизация сборки деплоя через CI/CD
Реализовать пайплайн GitlabCI, реализующий следующие этапы:
- проверка исходных файлов проекта на соответствование требованиям workflow (pre-code review)
- сборка docker image
- сканирование на уязвимости собранного docker image
- отправка docker image в _свой_ registry
- деплой на тестовое окружение (staging)
- прогон smoke-tests на тестовом окружении (staging)
- деплой на "боевое" окружение (prod) с уведомлением о начале и результате
### Observability
#### Мониторинг
1) Запустить сервер мониторинга
- Prometheus
- Grafana
- AlertManager
2) Настроить мониторинг компонентов проекта
- системные метрики хостов
- метрики nginx/postgres/redis/docker
- метрики приложения (если применимо)
3) Настроить оповещения по основным критичным метрикам
#### Логирование
1) Запустить сервер логирования
- Elasticsearch
- Logstash
- Kibana
2) Настроить сбор логов со всех компонентов системы в ELK
### Безопасность
1) Настроить firewall для доступа только к необходимым портам
2) _опционально_ организовать работу с секретами через HC Vault/Yandex LockBox
3) Обязательно осуществлять сканирование кода и docker images на уязвимости
